
SELECT
order_week::DATE AS order_week,
                 status,
                 COUNT(id) AS total_orders,
                 COUNT(id) FILTER (WHERE COUNT>0) AS orders_with_calls,
                 COUNT(id) FILTER (WHERE COUNT_of_non_ivr_calls>0) AS orders_with_non_ivr_calls,
                 avg(count) filter(WHERE count>0) AS AVG_enquires,
                 avg(count) filter(WHERE COUNT_of_inbound_calls>0) AS avg_inbound_enquires,
                 avg(count) filter(WHERE COUNT_of_outbound_calls>0) AS avg_outbound_enquires,
                 avg(count) filter(WHERE COUNT_of_non_ivr_calls>0) AS AVG_non_ivr_enquires,
                 avg(count) filter(WHERE COUNT_of_non_ivr_inbound_calls>0) AS AVG_non_ivr_inbound_enquires,
                 avg(count) filter(WHERE COUNT_of_non_ivr_outbound_calls>0) AS AVG_non_ivr_outbound_enquires,
                 COUNT(id) FILTER (
          		 WHERE
                 COUNT > 0
                 ) * 1.00 / COUNT(id) AS perc_orders_with_calls,
                 COUNT(id) FILTER (
                 WHERE
                 COUNT_of_inbound_calls > 0
                 ) * 1.00 / COUNT(id) AS perc_orders_with_inbound_calls,
                 COUNT(id) FILTER (
                 WHERE
                 COUNT_of_outbound_calls > 0
                 ) * 1.00 / COUNT(id) AS perc_orders_with_outbound_calls,
                 
                 COUNT(id) FILTER (
                 WHERE
                 COUNT_of_non_ivr_calls > 0
                 ) * 1.00 / COUNT(id) AS perc_orders_with_non_ivr_calls,
                 
                 COUNT(id) FILTER (
                 WHERE
                 COUNT_of_non_ivr_inbound_calls > 0
                 ) * 1.00 / COUNT(id) AS perc_orders_with_non_ivr_inbound_calls,
                 
                 COUNT(id) FILTER (
                 WHERE
                 COUNT_of_non_ivr_outbound_calls > 0
                 ) * 1.00 / COUNT(id) AS perc_orders_with_non_ivr_outbound_calls
                 
                 
                 FROM
                 (
                 SELECT
                 order_week,
                 status,
                 a.id,
                 COUNT(DISTINCT customer_crt_id),
                 COUNT(DISTINCT customer_crt_id) FILTER (WHERE ivr = 'none') AS COUNT_of_non_ivr_calls,
                 COUNT(DISTINCT customer_crt_id) FILTER (WHERE cr.caller_info -> 'channel' ='inbound') AS COUNT_of_inbound_calls,
                 COUNT(DISTINCT customer_crt_id) FILTER (WHERE cr.caller_info -> 'channel' = 'outbound') AS COUNT_of_outbound_calls,
                 COUNT(DISTINCT customer_crt_id) FILTER (WHERE cr.caller_info -> 'channel' = 'inbound' AND ivr = 'none') AS COUNT_of_non_ivr_inbound_calls,
                 COUNT(DISTINCT customer_crt_id) FILTER (WHERE cr.caller_info -> 'channel' = 'outbound' AND ivr = 'none') AS COUNT_of_non_ivr_outbound_calls
                 FROM
                 (
                 SELECT
                 orders.id,
                 driver_id,
                 case when orders.status = 5 and cancel_reason_id not in (68,70,80,79) then 'cancelled without attribution porter' when orders.status = 5 then 'cancelled with attribution porter' else 'completed' end as status ,
                 to_timestamp(pickup_time) + INTERVAL '5.5 hours' AS order_time_ist,
                 DATE_trunc(
                 'week',
                 to_timestamp(pickup_time) + INTERVAL '5.5 hours'
                 ) AS order_week
                 FROM
                 orders                          
                 WHERE
                 order_type = 0
                 AND orders.status in (4,5)
                 AND pickup_time BETWEEN
                 extract(epoch FROM date_trunc('week',current_date))::INTEGER - 19800 - 7*86400
                 AND extract(epoch FROM date_trunc('week',current_date))::INTEGER - 1980
                 AND driver_id not in (SELECT id FROM drivers WHERE is_test = TRUE )
                 AND 
                 	driver_id not in (

'38983',
'268586',
'273230',
'24238',
'37707',
'360614',
'231234',
'268580',
'386400',
'200889',
'312510',
'359901',
'215965',
'273895',
'281588',
'268576',
'21244',
'13826',
'37321',
'382694', 
'19327',
'154138',
'394158',
'402236',
'384289',
'371183',
'382130',
'135844',
'402252',
'402244',
'405064',
'200889',
'377826',
'96294',
'380337',
'376601',
'81666',
'388068',
'57761',
'215991',
'360614',
'403303',
'359901',
'77238',
'155556',
'382150',
'360082',
'231234',
'24237',
'394311',
'402115',
'395455',
'23403',
'99397',
'206348',
'66394',
'144356',
'143171',
'386400',
'384677',
'6313',
'281588',
'32961',
'24238',
'314970',
'397483',
'153040',
'159817',
'238884',
'134448',
'227593',
'354804',
'43485',
'172122',
'126552',
'100634',
'157696',
'77641',
'35344',
'301195',
'64704',
'130379',
'351045',
'352820',
'343251',
'219653',
'352031',
'154077',
'121197',
'143473',
'139608',
'92681',
'267508',
'65435',
'327875',
'177902',
'325834',
'136203',
'12062',
'83170',
'321256',
'180166',
'151168',
'158490',
'87494',
'137221',
'273230',
'312510',
'300481',
'158533',
'136251',
'147955',
'88807',
'93170',
'89247',
'45107',
'278267',
'227384',
'46283',
'231100',
'216224',
'214754',
'161541',
'144573',
'175667',
'198908',
'208374',
'201512',
'93920',
'202996',
'212457',
'112273',
'128927',
'142684',
'10448',
'96360',
'201756',
'222877',
'229992',
'205399',
'205371',
'210157',
'199294',
'201521',
'104192',
'102674',
'85890',
'219481',
'208365',
'121552',
'95279',
'128772',
'180778',
'175922',
'100906',
'89715',
'199071',
'222172',
'176315',
'207443',
'212476',
'209448',
'202293',
'112098',
'130628',
'66644',
'127905',
'214847',
'192192',
'104830',
'230043',
'180611',
'202950',
'101728',
'151942',
'199504',
'125668',
'124363',
'176583',
'88104',
'77920',
'192498',
'214921',
'202315',
'114696',
'146096',
'230021',
'104103',
'83856',
'76874',
'129638',
'168268',
'129640',
'95204',
'152019',
'52009',
'74741',
'110306',
'179427',
'146257',
'149460',
'65048',
'76638',
'152843',
'66782',
'90300',
'78159',
'67538',
'66171',
'143965',
'80435',
'89132',
'88530',
'66185',
'65879',
'163860',
'87088',
'84532',
'82708',
'175322',
'76171',
'98937',
'64874',
'91116',
'138334',
'78628',
'151539',
'64776',
'64844',
'69323',
'226903',
'110992',
'136307',
'77323',
'31313',
'178139',
'78314',
'142668',
'69439',
'93281',
'86280',
'82752',
'61626',
'99317',
'64929',
'63510',
'62671',
'64128',
'61700',
'54427',
'73568',
'55348',
'64510',
'191663',
'60865',
'60869',
'54443',
'94758',
'131703',
'61953',
'216287',
'118378',
'208993',
'67823',
'67838',
'56367',
'61244',
'62252',
'103956',
'202337',
'217491',
'99156',
'95619',
'56492',
'57611',
'167539',
'114992',
'111785',
'58631',
'278219',
'54696',
'19497',
'61391',
'64147',
'158835',
'84377',
'198914',
'50418',
'53865',
'92378',
'124684',
'121873',
'86442',
'53859',
'108578',
'69643',
'151782',
'58365',
'125503',
'96391',
'67042',
'50619',
'121850',
'112440',
'129646',
'98750',
'66590',
'114028',
'114029',
'158463',
'132078',
'110915',
'86217',
'58373',
'125685',
'132817',
'95884',
'102451',
'71765',
'64615',
'64652',
'78266',
'92240',
'54187',
'74359',
'223317',
'223316',
'223319',
'223318',
'223320',
'223321',
'223322',
'223324',
'95907',
'223325',
'223326',
'223328',
'223327',
'223329',
'171951',
'214424',
'63391',
'133509',
'76272',
'51127',
'98526',
'64607',
'56116',
'56549',
'138338',
'69967',
'173175',
'50201',
'95775',
'50812',
'145657',
'128151',
'71149',
'61182',
'71555',
'60479',
'111403',
'146784',
'90965',
'55410',
'51197',
'105861',
'49167',
'45019',
'63480',
'104917',
'40724',
'31160',
'99145',
'99147',
'102563',
'68192',
'76882',
'48343',
'126010',
'74342',
'48165',
'56391',
'24242',
'70739',
'97461',
'67544',
'67615',
'87712',
'142510',
'125716',
'105808',
'123315',
'21649',
'56767',
'44414',
'182592',
'55214',
'63172',
'287931',
'108809',
'51035',
'21594',
'217519',
'130604',
'99937',
'83878',
'101105',
'133692',
'89552',
'25524',
'25530',
'57503',
'21728',
'17374',
'141002',
'66464',
'102023',
'78146',
'100863',
'87834',
'20707',
'34243',
'20208',
'63346',
'123026',
'35150',
'35151',
'64642',
'106855',
'65783',
'67630',
'67771',
'50252',
'25615',
'70572',
'58943',
'79427',
'46537',
'93863',
'1246',
'105139',
'99754',
'74427',
'78587',
'66523',
'88190',
'68626',
'132643',
'65403',
'103228',
'88756',
'84063',
'20866',
'27375',
'34924',
'34925',
'29749',
'101649',
'216358',
'31290',
'135242',
'204690',
'58027',
'130689',
'32678',
'92438',
'21135',
'37321',
'31486',
'48464',
'637',
'32669',
'32670',
'32671',
'32672',
'104763',
'32673',
'137786',
'32674',
'108066',
'32675',
'19529',
'29990',
'50998',
'11930',
'206764',
'46874',
'53058',
'690',
'7876',
'214',
'102964',
'55588',
'86024',
'90382',
'48166',
'673',
'48923',
'6731',
'537',
'206',
'18251',
'40539',
'20099',
'5993',
'1403',
'202',
'32162',
'22347',
'18653',
'75028',
'103682',
'16517',
'15974',
'16014',
'876',
'107787',
'87698',
'1586',
'4048',
'635',
'1215',
'1213',
'523',
'807',
'88146',
'897',
'6340',
'764',
'6035',
'6311',
'181',
'18512',
'6315',
'89440',
'3852',
'17513',
'231',
'1039',
'16487',
'100895',
'667',
'805',
'72163',
'6053',
'15779',
'3563',
'11881',
'146',
'336',
'195',
'125511',
'5654',
'1664',
'6305',
'201',
'100168',
'1720',
'1135',
'8003',
'145',
'14336',
'6052',
'65433',
'97187',
'193',
'13533',
'64769',
'93488',
'15970',
'32597',
'95537',
'973',
'1216',
'99409',
'63472',
'32644',
'20641',
'490',
'519',
'5650',
'89495',
'169',
'82082',
'6433',
'10438',
'6301',
'88118',
'89208',
'5967',
'4958',
'197',
'12464',
'118929',
'4433',
'56953',
'56954',
'199',
'141076',
'331',
'1247',
'15969',
'16025',
'5994',
'15973',
'3500',
'491',
'7189',
'109185',
'196',
'4430',
'6308',
'58130',
'118932',
'58245',
'6306',
'207',
'198',
'1157',
'332',
'108526',
'803',
'200',
'5966',
'1214',
'991',
'205',
'284',
'204',
'206873',
'17143',
'25368',
'18055',
'18712',
'108251',
'62033',
'18545',
'105572',
'16845',
'57451',
'6309',
'71121',
'103506',
'125298',
'108032',
'129994',
'192386',
'53629',
'50632',
'130229',
'112581',
'47472',
'362',
'127946',
'21824',
'64297',
'18795',
'139137',
'127046',
'21183',
'14425',
'66830',
'144648',
'48199',
'112984',
'67336',
'69706',
'50023',
'92476',
'76848',
'66670',
'69630',
'120160',
'180083',
'47287',
'65379',
'103387',
'1817',
'41682',
'32598',
'32599',
'32600',
'34239',
'106574',
'61311',
'112171',
'51020',
'33260',
'230957',
'69138',
'79073',
'122721',
'61559',
'61528',
'110591',
'12341',
'103294',
'48135',
'118080',
'73535',
'49226',
'95741',
'76543',
'79234',
'115517',
'122577',
'58950',
'34236',
'57233',
'40517',
'51948',
'64668',
'48359',
'66064',
'140156',
'53425',
'94750',
'45290',
'102936',
'24240',
'93713',
'88551',
'128812',
'88010',
'110735',
'26099',
'121970',
'53925',
'30957',
'76285',
'139260',
'105081',
'47906',
'104057',
'73663',
'101367',
'117412',
'51999',
'60032',
'100839',
'119187',
'57473',
'73543',
'127919',
'69495',
'18061',
'130002',
'80304',
'106418',
'80501',
'37288',
'75307',
'63372',
'95783',
'16046',
'44388',
'114105',
'40088',
'104794',
'87750',
'31652',
'71632',
'88169',
'128469',
'33204',
'7764',
'33205',
'92997',
'57289',
'152689',
'117059',
'146807',
'76630',
'33261',
'109780',
'129693',
'124321',
'125286',
'32601',
'32602',
'72746',
'88061',
'41676',
'87117',
'38145',
'141572',
'87899',
'21261',
'62897',
'65574',
'65378',
'62352',
'124443',
'112913',
'76951',
'64971',
'40570',
'59793',
'123723',
'56249',
'141216',
'46225',
'63636',
'91288',
'128854',
'18362',
'64713',
'115115',
'138274',
'59887',
'84247',
'33210',
'55422',
'157334',
'62434',
'52471',
'145354',
'53185',
'48646',
'59117',
'114706',
'88573',
'71081',
'60407',
'118435',
'124134',
'104681',
'105195',
'27278',
'145275',
'52476',
'89234',
'118755',
'90182',
'32649',
'33632',
'43151',
'110009',
'78185',
'68335',
'52867',
'124243',
'149169',
'106263',
'63086',
'30952',
'30953',
'192413',
'48105',
'36121',
'81317',
'127292',
'64710',
'138000',
'124717',
'6732',
'51063',
'57462',
'69671',
'48767',
'38983',
'17141',
'138681',
'107657',
'118892',
'62295',
'80465',
'55827',
'95838',
'54050',
'95481',
'54387',
'95437',
'97813',
'126479',
'125729',
'160584',
'160030',
'52548',
'130738',
'59675',
'59813',
'101195',
'56956',
'29530',
'87328',
'115622',
'62010',
'82815',
'120778',
'128488',
'56957',
'56712',
'62192',
'67522',
'78248',
'68255',
'42696',
'42107',
'90561',
'124477',
'80490',
'110943',
'130255',
'102420',
'121446',
'93446',
'61099',
'62457',
'92263',
'63353',
'95848',
'54789',
'93274',
'97997',
'98604',
'119233',
'99478',
'106778',
'63984',
'89476',
'124722',
'142131',
'69710',
'76952',
'48997',
'29494',
'159818',
'102601',
'113992',
'111515',
'60485',
'86673',
'69722',
'78281',
'63145',
'115919',
'142230',
'33199',
'214513',
'103455',
'93611',
'33200',
'98609',
'66997',
'111462',
'146652',
'40498',
'33132',
'33208',
'33209',
'97531',
'538',
'34208',
'47803',
'54401',
'96471',
'51907',
'40631',
'108283',
'71503',
'98264',
'139282',
'121580',
'34928',
'149792',
'64159',
'45493',
'63374',
'106988',
'103365',
'114129',
'111781',
'49195',
'105305',
'91566',
'197032',
'88887',
'54891',
'8109',
'96733',
'71089',
'118745',
'106523',
'81398',
'45332',
'44149',
'73282',
'71004',
'52027',
'59244',
'130247',
'58711',
'98660',
'89951',
'127597',
'45522',
'90566',
'122862',
'103412',
'105756',
'53661',
'156629',
'154745',
'179691',
'55020',
'127912',
'53679',
'54097',
'102366',
'116430',
'51521',
'136079',
'126975',
'47804',
'55038',
'87002',
'56734',
'110885',
'62361',
'54432',
'83582',
'64636',
'50618',
'88920',
'67004',
'57276',
'123577',
'156720',
'53522',
'71815',
'64335',
'101528',
'115657',
'79769',
'127942',
'85807',
'87069',
'221905',
'57072',
'53397',
'120102',
'66089',
'101515',
'106580',
'63477',
'66928',
'195823',
'63358',
'103301',
'64656',
'97820',
'87144',
'81092',
'116803',
'221906',
'67245',
'64454',
'118760',
'59648',
'58511',
'93464',
'141218',
'93231',
'64123',
'57670',
'64460',
'73934',
'70680',
'95211',
'131055',
'118268',
'75579',
'173307',
'67170',
'154230',
'95752',
'129966',
'73587',
'115240',
'88430',
'62533',
'153562',
'124169',
'109770',
'66289',
'71137',
'61952',
'73026',
'63012',
'130271',
'102697',
'119533',
'67181',
'63169',
'99773',
'128279',
'107548',
'123689',
'69065',
'212297',
'212298',
'131566',
'81900',
'128030',
'92697',
'127303',
'70532',
'129980',
'70410',
'127368',
'94417',
'72047',
'123396',
'69741',
'70069',
'113782',
'72125',
'95996',
'105521',
'89315',
'75540',
'74893',
'114252',
'86293',
'81235',
'94679',
'92798',
'80264',
'99165',
'157012',
'108586',
'82778',
'80284',
'129988',
'114269',
'117680',
'113233',
'128252',
'106293',
'128166',
'83873',
'88446',
'96536',
'86210',
'109076',
'89945',
'96293',
'89740',
'88469',
'112828',
'113077',
'87495',
'105529',
'90158',
'92394',
'120357',
'127382',
'90672',
'90202',
'136968',
'119055',
'94118',
'136280',
'130850',
'90626',
'130048',
'90636',
'90752',
'94691',
'125775',
'101210',
'103702',
'94911',
'94729',
'143427',
'133246',
'138286',
'103861',
'109402',
'121483',
'158790',
'99724',
'147216',
'109267',
'111863',
'128298',
'147995',
'148620',
'131105',
'137656',
'121866',
'102329',
'103277',
'119946',
'112407',
'112713',
'108768',
'109109',
'130838',
'109839',
'140728',
'121273',
'128954',
'105684',
'143939',
'102728',
'133251',
'105687',
'108310',
'104600',
'111911',
'106464',
'107265',
'130780',
'107966',
'107322',
'130129',
'134039',
'110711',
'108504',
'108784',
'108705',
'113232',
'110804',
'111608',
'109680',
'159281',
'37168',
'111188',
'109948',
'129360',
'138327',
'122156',
'137827',
'126643',
'127670',
'126233',
'137645',
'123301',
'124662',
'71409',
'124675',
'127595',
'117334',
'46349',
'193986',
'134022',
'126627',
'125143',
'130423',
'121520',
'127684',
'126202',
'127596',
'126250',
'126258',
'127695',
'144647',
'133750',
'126717',
'130572',
'139359',
'126746',
'165062',
'149366',
'131629',
'126762',
'126304',
'127458',
'131520',
'127731',
'137151',
'132463',
'127763',
'126858',
'142237',
'131645',
'126867',
'126869',
'131422',
'129389',
'156312',
'32659',
'129542',
'131797',
'129404',
'134031',
'134617',
'137732',
'138694',
'132581',
'148145',
'134375',
'133460',
'134053',
'131816',
'139269',
'132764',
'134392',
'134065',
'137757',
'135231',
'134202',
'133778',
'140269',
'139532',
'138975',
'138916',
'135988',
'135996',
'139708',
'137372',
'146477',
'68638',
'146480',
'137419',
'137922',
'137462',
'138770',
'137487',
'138076',
'139634',
'139831',
'139914',
'141356',
'212318',
'139998',
'140686',
'144706',
'149443',
'165253',
'143069',
'143985',
'145419',
'149359',
'143386',
'140508',
'148067',
'158971',
'149032',
'155757',
'148423',
'145705',
'179192',
'145329',
'161154',
'142516',
'143367',
'152822',
'142201',
'140878',
'148431',
'142721',
'155571',
'142394',
'152617',
'149364',
'143095',
'143192',
'143156',
'146225',
'143638',
'146726',
'146943',
'152973',
'144568',
'145723',
'146083',
'144765',
'144804',
'144947',
'144957',
'145177',
'148811',
'147146',
'149554',
'283523',
'146616',
'149411',
'150146',
'147188',
'157636',
'152923',
'150969',
'152667',
'149087',
'149213',
'148913',
'149266',
'181551',
'150342',
'150055',
'150429',
'21727',
'150385',
'150492',
'150507',
'150583',
'151201',
'216480',
'153691',
'151620',
'153872',
'49381',
'163516',
'152171',
'152207',
'152869',
'154041',
'152336',
'155392',
'154416',
'153172',
'153697',
'156472',
'155227',
'154468',
'154078',
'154120',
'154148',
'155322',
'156239',
'59826',
'154233',
'154234',
'154189',
'154280',
'154289',
'157277',
'157329',
'157006',
'155109',
'155058',
'155070',
'219539',
'157094',
'156369',
'157663',
'157821',
'161489',
'158988',
'158991',
'159037',
'81367',
'159440',
'161006',
'230694',
'158696',
'163432',
'814',
'160529',
'161465',
'161033',
'160635',
'160791',
'163484',
'162321',
'162314',
'164772',
'162281',
'53997',
'158811',
'202676',
'163683',
'207677',
'182436',
'167734',
'24746',
'179231',
'203854',
'173336',
'188600',
'116367',
'145779',
'139101',
'175020',
'66456',
'117793',
'117262',
'69718',
'158318',
'181943',
'182305',
'231095',
'182755',
'203617',
'89335',
'228608',
'203064',
'231085',
'230129',
'214179',
'194850',
'201594',
'197590',
'214994',
'215748',
'195265',
'128491',
'203945',
'198012',
'202085',
'200107',
'202047',
'202111',
'193736',
'202049',
'202050',
'202092',
'202051',
'215126',
'216826',
'202055',
'202057',
'202059',
'202064',
'202095',
'202101',
'202065',
'202069',
'202070',
'202104',
'202075',
'202080',
'202082',
'202114',
'203279',
'200870',
'202168',
'201511',
'219586',
'202250',
'220906',
'217975',
'206500',
'218004',
'219614',
'219617',
'219642',
'218275',
'123556',
'219649',
'219651',
'219652',
'111947',
'110402',
'233080',
'59787',
'218357',
'218370',
'218471',
'218512',
'218605',
'218737',
'220969',
'129205',
'219321',
'219427',
'99260',
'219815',
'219994',
'220029',
'122912',
'220729',
'212832',
'221517',
'222123',
'222741',
'222728',
'223281',
'223140',
'223169',
'223464',
'223387',
'123034',
'223810',
'223812',
'223814',
'223815',
'223816',
'223818',
'223817',
'224313',
'225144',
'250447',
'230872',
'225503',
'225924',
'225809',
'228724',
'226307',
'231330',
'226590',
'226606',
'11872',
'231375',
'227509',
'230968',
'215077',
'230225',
'227721',
'227806',
'228981',
'207620',
'83183',
'229323',
'230414',
'230418',
'230421',
'230442',
'229531',
'229550',
'229764',
'233222',
'229821',
'232568',
'234305',
'233934',
'233956',
'234001',
'233837',
'234613',
'234758',
'234954',
'228072',
'236597',
'236589',
'236585',
'236590',
'236586',
'236587',
'236591',
'236593',
'236594',
'236592',
'236595',
'236596',
'236598',
'236599',
'238166',
'225471',
'236821',
'47574',
'246076',
'79408',
'250422',
'9017',
'15972',
'15777',
'6314',
'223323',
'96189',
'258204',
'273316',
'273322',
'32559',
'77322',
'154235',
'259517',
'139501',
'268576',
'268580',
'268586',
'94928',
'151071',
'180855',
'45372',
'151479',
'101147',
'158298',
'37707',
'285731',
'216799',
'108661',
'81447',
'300502',
'300506',
'197307',
'302287',
'302421',
'56232',
'124507',
'273321',
'64749',
'216792',
'126004',
'372199',
'215965',
'130047',
'24241',
'1473',
'23555',
'273895',
'21244',
'13826',
'13826',
'273895',
'20679',
'21244')	
                
             ) a
                 LEFT JOIN caller_responses cr ON a.id = cr.order_id
                 GROUP BY
                 1,
                 2,
                 3
                 ) aa
                 GROUP BY
                 1,
                 2
                 ORDER BY
                 1,2;

